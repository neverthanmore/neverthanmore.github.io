---
layout: post
title: ES6学习记录
categories: nodejs
---

​        最近从express框架转到koa框架，中间件基于generator实现的，框架中的代码满眼都是ES6，对于刚迈入js阵营里的人是个很大的考验，所以在这里记录es6学习的点滴，不积跬步无以至千里，不积小流无以成江河(本次学习主要是为学习node配合，要使用在浏览器端还过早)。

​	想使用ES6语法编写ES5的同学，可以去了解一下ES6转码器，强力推荐[BABEL](https://babeljs.io/)

### let and const

1. 使用let取代var

   看完`let`块级作用域,感觉完全可以取代`var`，let不存在变量提升，并且声明的变量只在声明的代码块中生效，没有任何副作用，在for循环中使用十分恰当。

   ```js
   //开启严格模式
   'use strict'

   for(let i = 0; i < 5; i++){
     console.log(i) // 0 1 2 3 4
     {
       let i = 100;
       console.log(i); //100
     }
   }
   ```

2. const定义全局常量

   javascript精粹这本书里面说过为了减少全局变量的污染，就是建立一个唯一的全局变量，其实在全局环境中设置常量比变量好很多，并且配合解构赋值简直完美。

   ```js
   //before
   var initData = {}, globalData = {};

   //now
   const [initData, globalData] = [{}, {}];
   ```

### 解构赋值

1. 基本使用方法(ps: 感觉这个东西简直是神器，非常实用，简化代码量，并在特殊情景下有妙用)

   ```js
   //(1)数组的解构赋值
   let [a, b, c] = [1, 2, 3];
   a // 1
   b // 2
   c // 3

   //(2)对象的解构赋值
   var { name, sex } = {name: 'neverthanmore', sex: 'male'}
   name // neverthanmore
   sex  // male

   //(3)函数参数的解构赋值
   function plusFullName([firstName, lastName]){
     return firstName + lastName;
   }
   plusFullName(['never', 'thanmore']);
   ```

2. 他的使用场景非常多，下面我们介绍一些使用案列

   * 交换变量的值

     ```js
     //before
     let a = 1, b = 2, temp;
     temp = a;
     a = b;
     b = temp;

     //now
     let [x, y] = [1, 2];
     [x, y] = [y, x]; //easy?
     ```

   * 配合函数使用反悔多个值

     ```js
     //before(之前返回多个值会放在对象中)
     function oldGetMultiReturn(){
       return {
         a: 'never',
         b: 'than',
         c: 'more'
       }
     }
     let valueList = oldGetMultiReturn();
     let a = valueList.a, b = valueList.b, c = valueList.c;

     //now
     function newGetMultiRetuen(){
       return ['never', 'than', 'more'];
     }
     let [a, b, c] = newGetMultiRetuen();
     ```

   * 提取json值

     ```js
     var json = {
       success: true,
       data: ['never', 'than', 'more'],
       code: 10000,
       msg: '成功'
     };
     let {su, da, co, ms} = json;
     su // true
     da // ['never', 'than', 'more']
     co // 10000
     ms // '成功'
     ```

   * 遍历Map结构

     ```js
     var map = new Map();
     map.set('firstName', 'never');
     map.set('lastName', 'thanmore');
     for(let [key, value] of map){
       console.log(key + 'is' + value);
     }
     // firstName is never
     //lastName is thanmore
     ```

   ### 字符串

   ES6中新加的模板功能可以避免使用`+`来连接变量，静态字符串使用单引号或者反引号，

   ```js
   const firstName = 'never';
   const fullName = `${firstName}thanmore`;
   ```

   ​



